@use super::super::super::base;
@use crate::models::category::Category;
@use super::super::super::misc::csrf_hidden_input;
@use crate::render::*;

@(ctx: &GlobalContext, categories: Vec<Category>)

@:base(ctx, "Categories", {}, {}, {
	<table>
		<thead>
			<tr>
				<th>Slug</th>
				<th>Name</th>
				<th>Description</th>
				<th>Order</th>
				<th>Parent</th>
				<th></th>
			</tr>
		</thead>
		<tbody>@for cat in categories {
			<tr>
				<form method="POST" action="/admin/category/update">
					<input type="hidden" name="target" value="@cat.id" />
					<td><input type="text" name="slug" value="@cat.slug" /></td>
					<td><input type="text" name="name" value="@cat.name" /></td>
					<td><textarea name="description">@if let Some(desc) = cat.description {@desc}</textarea></td>
					<td><input type="number" name="order" value="@cat.order" /></td>
					<td><input type="text" name="parent" @if let Some(pid) = cat.parent {value="@pid" }/></td>
					@:csrf_hidden_input(ctx)
					<td><input type="submit" value="Modify"/></td>
				</form>
			</tr>}
			<tr>
				<form method="POST" action="/admin/category/update">
					<td><input type="text" name="slug" placeholder="Slug" /></td>
					<td><input type="text" name="name" placeholder="Name" /></td>
					<td><textarea name="description" placeholder="Description"></textarea></td>
					<td><input type="number" name="order" value="0" /></td>
					<td><input type="text" name="parent" placeholder="Parent slug (optional)" /></td>
					@:csrf_hidden_input(ctx)
					<td><input type="submit" value="Add"/></td>
				</form>
			</tr>
		</tbody>
	</table>
}, {})
